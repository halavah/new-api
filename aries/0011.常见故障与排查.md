# 0011. 常见故障与排查

## 适合人群
- Go 初学者（有 Java 背景），需要快速定位常见问题。

## 启动类问题
- 端口占用：3000/5173 被占用 → 启动脚本会尝试释放；仍失败可改 `PORT`/`WEB_PORT`。
- 缺少 web/dist：仅后端启动访问根路径报错 → 先 `bun run build` 或跑前端 dev。
- Go/bun 未安装：检查 PATH，确认版本（Go 1.25+，bun 官网安装）。

## 数据库问题
- SQLite 权限/锁：确保运行用户可写；高并发建议换 MySQL/Postgres。
- DSN 错误：`SQL_DSN` 格式错误或未设置 parseTime（MySQL 已自动补齐）。
- 迁移失败：查看日志（`logs/`），确认数据库连接与权限。

## 配置与环境
- 会话/加密密钥缺失：多机或 Redis 必配 `SESSION_SECRET`、`CRYPTO_SECRET`。
- Redis 未启用：`REDIS_CONN_STRING` 未设置；若需缓存/会话/队列请配置。
- 跨域：前端调用报 CORS → 检查 `middleware/cors.go` 设置。

## Relay/调用问题
- 下游超时/失败：检查 `RELAY_TIMEOUT`、`STREAMING_TIMEOUT`、网络连通性。
- 模型/渠道不可用：确认渠道权重/可用状态，模型映射配置是否正确。
- 计费/额度异常：查看日志与数据库用量记录，确认配额与价格配置。

## 前端/桌面
- Dev 端口冲突：改 `WEB_PORT`；或关闭占用进程。
- 多语言缺失：新增文案未同步到各语言文件，导致显示异常。
- Electron 启动：确保已构建前端，主进程加载路径正确。

## 调试技巧
- 日志：查看 `logs/oneapi-*.log`，关注 ERROR/FATAL。
- Pprof：按需启用，分析 CPU/内存热点。
- 最小化重现：用 curl/postman/前端 dev 单独验证接口链路。

## 参考
- 环境与配置：`0001`、`0003`
- 主入口与路由：`0002`
- 数据库与模型：`0005`
- Relay：`0007`

